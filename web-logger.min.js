var WebLogger=function(e){"use strict";var r,t
;function n(e){
return!("undefined"!=typeof EventTarget&&e instanceof EventTarget)||"undefined"!=typeof EventSource&&e instanceof EventSource
}
(r=e.LogLevel||(e.LogLevel={}))[r.Trace=1]="Trace",r[r.Debug=2]="Debug",r[r.Info=4]="Info",
r[r.UserAction=8]="UserAction",
r[r.Action=16]="Action",r[r.UserWarning=32]="UserWarning",
r[r.UserError=64]="UserError",
r[r.Warning=128]="Warning",r[r.Error=256]="Error",
r[r.Fatal=512]="Fatal",r[r.None=0]="None",
r[r.Any=1023]="Any",(t=e.ActionMode||(e.ActionMode={}))[t.Default=0]="Default",
t[t.Always=1]="Always",t[t.Never=2]="Never"
;var o=1,i=new WeakMap;function a(e){
var r=i.get(e)
;return null==r&&(r=o++,i.set(e,r)),r}
function s(e,r){
var t=void 0===r?{}:r,o=t.maxLevel,i=void 0===o?15:o,s=t.maxValueSize,l=void 0===s?5e3:s,u=t.maxFuncSize,c=void 0===u?100:u,f=t.maxProperties,h=void 0===f?50:f,g=t.maxListSize,v=void 0===g?10:g,p=t.maxResultSize,d=void 0===p?5e4:p,y=t.filter,L=void 0===y?n:y
;if(null==e)return e+""
;var b=[],m=0,w=new String("Overflow")
;function S(e,r){var t=Math.min(e.length,l,d-m)
;if(null!=r&&t>r&&(t=r),e.length>t&&(e=e.substring(0,t)+"..."),
b.push(e),(m+=e.length)>=d)throw b.push("..."),
m+=3,w}var _=new Set;try{!function e(r,t,n){
if(void 0===n&&(n=0),void 0!==r)if(null!==r)if("number"!=typeof r&&"boolean"!=typeof r){
if("string"==typeof r)return S('"'),
S(r),void S('"')
;if(r instanceof Date)return S("<Date> "),void S(Number.isNaN(r.getTime())?"NaN":r.toISOString())
;if(r instanceof Error&&(r._stack=r.stack||r.toString()),
"object"!=typeof r)"function"==typeof r?S(r.toString(),c):S(r.toString());else{
if(r.valueOf){var o=r.valueOf();if(o!==r){
if(r.constructor){S("<"),S(r.constructor.name)
;var s=a(r);s&&(S("-"),S(s.toString())),S("> ")}
return void e(o,t,n)}}if(n>=i)return void S("...")
;if(n++,!L(r))return S("<"),S(r.constructor.name),
void S("> {...}");var l=h,u=v
;if(_.has(r)?(l=0,u=0):_.add(r),Array.isArray(r))S("["),
l=u;else if(r.constructor){
S("<"),S(r.constructor.name);var f=a(r)
;f&&(S("-"),S(f.toString())),S("> {")}else S("{")
;var g=t+"\t",p=0
;if(p>=l)S("...");else for(var d in r){
if(S(0===p?"\r\n":",\r\n"),p>=l){S(g),S("...\r\n")
;break}
S(g),S(""===d?'""':d),S(": "),e(r[d],g,n),p++}
if(p>0&&(S(",\r\n"),S(t)),Array.isArray(r)?S("]"):S("}"),
!Array.isArray(r)&&Symbol.iterator in r){
if(S("["),(p=0)>=u)S("...");else try{
for(var y,b=r[Symbol.iterator];!(y=b()).done;){
var m=y.value
;if(S(p>0?",\r\n":"\r\n"),S(t),S(p.toString()),S(": "),e(m,g,n),++p>=u){
S(g),S("...");break}}}catch(e){
S("<iterate error>")}p>0&&(S(",\r\n"),S(t)),S("]")
}}
}else S(r.toString());else S("null");else S("undefined")
}(e,"",null)}catch(e){if(e!==w)throw e}
return b.join("")}function l(e,r,t,n,o,i,a){try{
var s=e[i](a),l=s.value}catch(e){return void t(e)}
s.done?r(l):Promise.resolve(l).then(n,o)}
function u(e){return function(){
var r=this,t=arguments
;return new Promise((function(n,o){
var i=e.apply(r,t);function a(e){
l(i,n,o,a,s,"next",e)}function s(e){
l(i,n,o,a,s,"throw",e)}a(void 0)}))}}
function c(e,r){
if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")
}function f(e,r){for(var t=0;t<r.length;t++){
var n=r[t]
;n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),
Object.defineProperty(e,n.key,n)}}
function h(e,r,t){
return r&&f(e.prototype,r),t&&f(e,t),e}
function g(){return(g=Object.assign||function(e){
for(var r=1;r<arguments.length;r++){
var t=arguments[r]
;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])
}return e}).apply(this,arguments)}function v(e,r){
if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function")
;e.prototype=Object.create(r&&r.prototype,{
constructor:{value:e,writable:!0,configurable:!0}
}),r&&d(e,r)}function p(e){
return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){
return e.__proto__||Object.getPrototypeOf(e)})(e)}
function d(e,r){
return(d=Object.setPrototypeOf||function(e,r){
return e.__proto__=r,e})(e,r)}function y(){
if("undefined"==typeof Reflect||!Reflect.construct)return!1
;if(Reflect.construct.sham)return!1
;if("function"==typeof Proxy)return!0;try{
return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),
!0}catch(e){return!1}}function L(e,r,t){
return(L=y()?Reflect.construct:function(e,r,t){
var n=[null];n.push.apply(n,r)
;var o=new(Function.bind.apply(e,n))
;return t&&d(o,t.prototype),o
}).apply(null,arguments)}function b(e,r){
return!r||"object"!=typeof r&&"function"!=typeof r?function(e){
if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
;return e}(e):r}function m(e){var r=y()
;return function(){var t,n=p(e);if(r){
var o=p(this).constructor
;t=Reflect.construct(n,arguments,o)
}else t=n.apply(this,arguments);return b(this,t)}}
function w(e,r,t){
return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,r,t){
var n=function(e,r){
for(;!Object.prototype.hasOwnProperty.call(e,r)&&null!==(e=p(e)););
return e}(e,r);if(n){
var o=Object.getOwnPropertyDescriptor(n,r)
;return o.get?o.get.call(t):o.value}})(e,r,t||e)}
function S(r,t,n){
return r===e.ActionMode.Always||r!==e.ActionMode.Never&&0!=(t&n)
}var _=function(){function r(t){
var n=t.name,o=t.logger,i=t.allowLogLevels,a=t.maxLogSize
;c(this,r),this._queue=[],
this.name=n,this._logger=o,this.allowLogLevels=i||e.LogLevel.Any,
this._maxLogSize=a||5e4}var t;return h(r,[{
key:"init",value:function(){}},{key:"canLog",
value:function(r){
return!this.disabled&&S(r.handlersModes&&(r.handlersModes[this.name]||r.handlersModes._all)||e.ActionMode.Default,this.allowLogLevels,r.level)
}},{key:"onError",value:function(r,t){var n=this
;E(r,t,this._logger,(function(r){
r.handlersModes||(r.handlersModes={}),r.handlersModes[n.name]=e.ActionMode.Never
}))}},{key:"enqueueLog",value:function(e){
var r=this.canLog(e)
;this._queue.push(e),r&&!this._inProcess&&this.handleLogs()
}},{key:"handleLogs",
value:(t=u(regeneratorRuntime.mark((function e(){
var r,t,n,o,i,a,s=this
;return regeneratorRuntime.wrap((function(e){
for(;;)switch(e.prev=e.next){case 0:
if(!this._inProcess){e.next=2;break}
return e.abrupt("return");case 2:
e.prev=2,r=this._queue;case 4:t=r.length,n=0
;case 6:if(!(n<t)){e.next=12;break}
if(!this.canLog(r[n])){e.next=9;break}
return e.abrupt("break",12);case 9:n++,e.next=6
;break;case 12:if(!(n>=r.length)){e.next=15;break}
return r.length=0,e.abrupt("break",37);case 15:
o=n,i=0;case 17:
if(!((i+=r[o].bodyString.length)>=this._maxLogSize)){
e.next=21;break}return e.abrupt("break",26)
;case 21:if(0!==o){e.next=23;break}
return e.abrupt("break",26);case 23:o--,e.next=17
;break;case 26:
return a=r.slice(o,n+1),r.splice(0,n+1),e.prev=28,e.next=31,this.handleLog(a)
;case 31:e.next=36;break;case 33:
e.prev=33,e.t0=e.catch(28),this.onError(a,e.t0)
;case 36:if(r.some((function(e){return s.canLog(e)
}))){e.next=4;break}case 37:
return e.prev=37,this._inProcess=!1,e.finish(37)
;case 40:case"end":return e.stop()}
}),e,this,[[2,,37,40],[28,33]])}))),function(){
return t.apply(this,arguments)})}]),r}()
;function E(r,t,n,o){var i,a=r[r.length-1]
;n.log((i={level:e.LogLevel.Error,
messagesOrErrors:["Logger self error",t],
handlersModes:a.handlersModes},o(i),i))}
var k=function(e){v(n,e);var r,t=m(n)
;function n(e,r){return c(this,n),t.call(this,{
name:"emitEvent",logger:e,allowLogLevels:r})}
return h(n,[{key:"handleLog",
value:(r=u(regeneratorRuntime.mark((function e(r){
var t,n
;return regeneratorRuntime.wrap((function(e){
for(;;)switch(e.prev=e.next){case 0:t=0,n=r.length
;case 1:if(!(t<n)){e.next=7;break}
return e.next=4,this._logger.onLog(r[t]);case 4:
t++,e.next=1;break;case 7:case"end":
return e.stop()}}),e,this)}))),function(e){
return r.apply(this,arguments)})}]),n
}(_),A=function(){function r(t){c(this,r)
;for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i]
;this.name=o[0].name,
this.logHandlers=o,this.allowLogLevels=e.LogLevel.Any
}return h(r,[{key:"init",value:function(){
for(var e=0,r=this.logHandlers.length;e<r;e++)this.logHandlers[e].init()
}},{key:"enqueueLog",value:function(e){
for(var r=0,t=this.logHandlers.length;r<t;r++)this.logHandlers[r].enqueueLog(e)
}}]),r}();function O(e){
return new Promise((function(r){setTimeout(r,e)}))
}var x,j,T={SparkMD5:(function(e,r){
e.exports=function(e){
var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"]
;function t(e,r){var t=e[0],n=e[1],o=e[2],i=e[3]
;n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&o|~n&i)+r[0]-680876936|0)<<7|t>>>25)+n|0)&n|~t&o)+r[1]-389564586|0)<<12|i>>>20)+t|0)&t|~i&n)+r[2]+606105819|0)<<17|o>>>15)+i|0)&i|~o&t)+r[3]-1044525330|0)<<22|n>>>10)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&o|~n&i)+r[4]-176418897|0)<<7|t>>>25)+n|0)&n|~t&o)+r[5]+1200080426|0)<<12|i>>>20)+t|0)&t|~i&n)+r[6]-1473231341|0)<<17|o>>>15)+i|0)&i|~o&t)+r[7]-45705983|0)<<22|n>>>10)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&o|~n&i)+r[8]+1770035416|0)<<7|t>>>25)+n|0)&n|~t&o)+r[9]-1958414417|0)<<12|i>>>20)+t|0)&t|~i&n)+r[10]-42063|0)<<17|o>>>15)+i|0)&i|~o&t)+r[11]-1990404162|0)<<22|n>>>10)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&o|~n&i)+r[12]+1804603682|0)<<7|t>>>25)+n|0)&n|~t&o)+r[13]-40341101|0)<<12|i>>>20)+t|0)&t|~i&n)+r[14]-1502002290|0)<<17|o>>>15)+i|0)&i|~o&t)+r[15]+1236535329|0)<<22|n>>>10)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&i|o&~i)+r[1]-165796510|0)<<5|t>>>27)+n|0)&o|n&~o)+r[6]-1069501632|0)<<9|i>>>23)+t|0)&n|t&~n)+r[11]+643717713|0)<<14|o>>>18)+i|0)&t|i&~t)+r[0]-373897302|0)<<20|n>>>12)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&i|o&~i)+r[5]-701558691|0)<<5|t>>>27)+n|0)&o|n&~o)+r[10]+38016083|0)<<9|i>>>23)+t|0)&n|t&~n)+r[15]-660478335|0)<<14|o>>>18)+i|0)&t|i&~t)+r[4]-405537848|0)<<20|n>>>12)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&i|o&~i)+r[9]+568446438|0)<<5|t>>>27)+n|0)&o|n&~o)+r[14]-1019803690|0)<<9|i>>>23)+t|0)&n|t&~n)+r[3]-187363961|0)<<14|o>>>18)+i|0)&t|i&~t)+r[8]+1163531501|0)<<20|n>>>12)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n&i|o&~i)+r[13]-1444681467|0)<<5|t>>>27)+n|0)&o|n&~o)+r[2]-51403784|0)<<9|i>>>23)+t|0)&n|t&~n)+r[7]+1735328473|0)<<14|o>>>18)+i|0)&t|i&~t)+r[12]-1926607734|0)<<20|n>>>12)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n^o^i)+r[5]-378558|0)<<4|t>>>28)+n|0)^n^o)+r[8]-2022574463|0)<<11|i>>>21)+t|0)^t^n)+r[11]+1839030562|0)<<16|o>>>16)+i|0)^i^t)+r[14]-35309556|0)<<23|n>>>9)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n^o^i)+r[1]-1530992060|0)<<4|t>>>28)+n|0)^n^o)+r[4]+1272893353|0)<<11|i>>>21)+t|0)^t^n)+r[7]-155497632|0)<<16|o>>>16)+i|0)^i^t)+r[10]-1094730640|0)<<23|n>>>9)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n^o^i)+r[13]+681279174|0)<<4|t>>>28)+n|0)^n^o)+r[0]-358537222|0)<<11|i>>>21)+t|0)^t^n)+r[3]-722521979|0)<<16|o>>>16)+i|0)^i^t)+r[6]+76029189|0)<<23|n>>>9)+o|0,
n=((n+=((o=((o+=((i=((i+=((t=((t+=(n^o^i)+r[9]-640364487|0)<<4|t>>>28)+n|0)^n^o)+r[12]-421815835|0)<<11|i>>>21)+t|0)^t^n)+r[15]+530742520|0)<<16|o>>>16)+i|0)^i^t)+r[2]-995338651|0)<<23|n>>>9)+o|0,
n=((n+=((i=((i+=(n^((t=((t+=(o^(n|~i))+r[0]-198630844|0)<<6|t>>>26)+n|0)|~o))+r[7]+1126891415|0)<<10|i>>>22)+t|0)^((o=((o+=(t^(i|~n))+r[14]-1416354905|0)<<15|o>>>17)+i|0)|~t))+r[5]-57434055|0)<<21|n>>>11)+o|0,
n=((n+=((i=((i+=(n^((t=((t+=(o^(n|~i))+r[12]+1700485571|0)<<6|t>>>26)+n|0)|~o))+r[3]-1894986606|0)<<10|i>>>22)+t|0)^((o=((o+=(t^(i|~n))+r[10]-1051523|0)<<15|o>>>17)+i|0)|~t))+r[1]-2054922799|0)<<21|n>>>11)+o|0,
n=((n+=((i=((i+=(n^((t=((t+=(o^(n|~i))+r[8]+1873313359|0)<<6|t>>>26)+n|0)|~o))+r[15]-30611744|0)<<10|i>>>22)+t|0)^((o=((o+=(t^(i|~n))+r[6]-1560198380|0)<<15|o>>>17)+i|0)|~t))+r[13]+1309151649|0)<<21|n>>>11)+o|0,
n=((n+=((i=((i+=(n^((t=((t+=(o^(n|~i))+r[4]-145523070|0)<<6|t>>>26)+n|0)|~o))+r[11]-1120210379|0)<<10|i>>>22)+t|0)^((o=((o+=(t^(i|~n))+r[2]+718787259|0)<<15|o>>>17)+i|0)|~t))+r[9]-343485551|0)<<21|n>>>11)+o|0,
e[0]=t+e[0]|0,
e[1]=n+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0}
function n(e){var r,t=[]
;for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24)
;return t}function o(e){var r,t=[]
;for(r=0;r<64;r+=4)t[r>>2]=e[r]+(e[r+1]<<8)+(e[r+2]<<16)+(e[r+3]<<24)
;return t}function i(e){
var r,o,i,a,s,l,u=e.length,c=[1732584193,-271733879,-1732584194,271733878]
;for(r=64;r<=u;r+=64)t(c,n(e.substring(r-64,r)))
;for(o=(e=e.substring(r-64)).length,
i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<o;r+=1)i[r>>2]|=e.charCodeAt(r)<<(r%4<<3)
;if(i[r>>2]|=128<<(r%4<<3),
r>55)for(t(c,i),r=0;r<16;r+=1)i[r]=0
;return a=(a=8*u).toString(16).match(/(.*?)(.{0,8})$/),
s=parseInt(a[2],16),l=parseInt(a[1],16)||0,
i[14]=s,i[15]=l,t(c,i),c}function a(e){
var r,n,i,a,s,l,u=e.length,c=[1732584193,-271733879,-1732584194,271733878]
;for(r=64;r<=u;r+=64)t(c,o(e.subarray(r-64,r)))
;for(n=(e=r-64<u?e.subarray(r-64):new Uint8Array(0)).length,
i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
r=0;r<n;r+=1)i[r>>2]|=e[r]<<(r%4<<3)
;if(i[r>>2]|=128<<(r%4<<3),r>55)for(t(c,i),r=0;r<16;r+=1)i[r]=0
;return a=(a=8*u).toString(16).match(/(.*?)(.{0,8})$/),
s=parseInt(a[2],16),l=parseInt(a[1],16)||0,
i[14]=s,i[15]=l,t(c,i),c}function s(e){var t,n=""
;for(t=0;t<4;t+=1)n+=r[e>>8*t+4&15]+r[e>>8*t&15]
;return n}function l(e){var r
;for(r=0;r<e.length;r+=1)e[r]=s(e[r])
;return e.join("")}function u(e){
return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),
e}function c(e,r){
var t,n=e.length,o=new ArrayBuffer(n),i=new Uint8Array(o)
;for(t=0;t<n;t+=1)i[t]=e.charCodeAt(t)
;return r?i:o}function f(e){
return String.fromCharCode.apply(null,new Uint8Array(e))
}function h(e,r,t){
var n=new Uint8Array(e.byteLength+r.byteLength)
;return n.set(new Uint8Array(e)),
n.set(new Uint8Array(r),e.byteLength),t?n:n.buffer
}function g(e){var r,t=[],n=e.length
;for(r=0;r<n-1;r+=2)t.push(parseInt(e.substr(r,2),16))
;return String.fromCharCode.apply(String,t)}
function v(){this.reset()}
return l(i("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){
function r(e,r){
return(e=0|e||0)<0?Math.max(e+r,0):Math.min(e,r)}
ArrayBuffer.prototype.slice=function(t,n){
var o,i,a,s,l=this.byteLength,u=r(t,l),c=l
;return n!==e&&(c=r(n,l)),u>c?new ArrayBuffer(0):(o=c-u,
i=new ArrayBuffer(o),a=new Uint8Array(i),
s=new Uint8Array(this,u,o),a.set(s),i)}
}(),v.prototype.append=function(e){
return this.appendBinary(u(e)),this
},v.prototype.appendBinary=function(e){
this._buff+=e,this._length+=e.length
;var r,o=this._buff.length
;for(r=64;r<=o;r+=64)t(this._hash,n(this._buff.substring(r-64,r)))
;return this._buff=this._buff.substring(r-64),this
},v.prototype.end=function(e){
var r,t,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
;for(r=0;r<o;r+=1)i[r>>2]|=n.charCodeAt(r)<<(r%4<<3)
;return this._finish(i,o),t=l(this._hash),
e&&(t=g(t)),this.reset(),t
},v.prototype.reset=function(){
return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],
this},v.prototype.getState=function(){return{
buff:this._buff,length:this._length,
hash:this._hash.slice()}
},v.prototype.setState=function(e){
return this._buff=e.buff,this._length=e.length,
this._hash=e.hash,this
},v.prototype.destroy=function(){
delete this._hash,delete this._buff,delete this._length
},v.prototype._finish=function(e,r){var n,o,i,a=r
;if(e[a>>2]|=128<<(a%4<<3),a>55)for(t(this._hash,e),
a=0;a<16;a+=1)e[a]=0
;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(n[2],16),
i=parseInt(n[1],16)||0,
e[14]=o,e[15]=i,t(this._hash,e)
},v.hash=function(e,r){return v.hashBinary(u(e),r)
},v.hashBinary=function(e,r){var t=l(i(e))
;return r?g(t):t},v.ArrayBuffer=function(){
this.reset()
},v.ArrayBuffer.prototype.append=function(e){
var r,n=h(this._buff.buffer,e,!0),i=n.length
;for(this._length+=e.byteLength,r=64;r<=i;r+=64)t(this._hash,o(n.subarray(r-64,r)))
;return this._buff=r-64<i?new Uint8Array(n.buffer.slice(r-64)):new Uint8Array(0),
this},v.ArrayBuffer.prototype.end=function(e){
var r,t,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
;for(r=0;r<o;r+=1)i[r>>2]|=n[r]<<(r%4<<3)
;return this._finish(i,o),t=l(this._hash),
e&&(t=g(t)),this.reset(),t
},v.ArrayBuffer.prototype.reset=function(){
return this._buff=new Uint8Array(0),this._length=0,
this._hash=[1732584193,-271733879,-1732584194,271733878],
this},v.ArrayBuffer.prototype.getState=function(){
var e=v.prototype.getState.call(this)
;return e.buff=f(e.buff),e
},v.ArrayBuffer.prototype.setState=function(e){
return e.buff=c(e.buff,!0),v.prototype.setState.call(this,e)
},v.ArrayBuffer.prototype.destroy=v.prototype.destroy,
v.ArrayBuffer.prototype._finish=v.prototype._finish,
v.ArrayBuffer.hash=function(e,r){
var t=l(a(new Uint8Array(e)));return r?g(t):t},v
}()}(j={path:x,exports:{},require:function(e,r){
return function(){
throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")
}(null==r&&j.path)}},j.exports),j.exports)}
;function U(e){var r=new T.SparkMD5
;return r.append(e),r.end()}
var M=/\s+/,N=/[^\S\n]+/,H=/([^\S\n]*\n[^\S\n]*)/
;var C=function(r){v(o,r);var t,n=m(o)
;function o(e,r,t){var i
;return c(this,o),(i=n.call(this,{name:"sendLog",
logger:e,allowLogLevels:r})).logUrl=t,i}
return h(o,[{key:"handleLog",
value:(t=u(regeneratorRuntime.mark((function r(t){
var n,o,i,a,s,l,u,c,f,h,v,p=this
;return regeneratorRuntime.wrap((function(r){
for(;;)switch(r.prev=r.next){case 0:
if((n=this.logUrl)&&n.length){r.next=3;break}
return r.abrupt("return");case 3:
o=t[t.length-1],i=function(){
for(var r,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i]
;p._logger.log({level:e.LogLevel.Error,
messagesOrErrors:n,
handlersModes:g({},o.handlersModes,(r={},r[p.name]=e.ActionMode.Never,
r))})
},a=!1,s=t.slice().reverse().map((function(r,t){
var n,o="["+r.dateString+"]["+p._logger.appName+"]["+e.LogLevel[r.level]+"]["+t+"]: "+r.bodyString
;return 0===t&&(o+="\r\n\r\nAppInfo: "+r.appInfo),
(n=o)&&n.replace(/[&<"']/g,(function(e){switch(e){
case"&":return"&amp;";case"<":return"&lt;"
;case'"':return"&quot;";default:return"&#039;"}}))
})).join("\r\n<hr>\r\n"),s=o.md5Hash+"\r\n\r\n"+s,
l=U(o.md5Hash+"607bf405-a5a8-4b8c-aa61-41e8c1208dba"),
u={Token:l,Hash:o.md5Hash,
AppName:this._logger.appName,
AppVersion:this._logger.appVersion,
Type:e.LogLevel[o.level],
Time:o.time.toISOString(),MessageFull:s,
MessageShort:(d=o.bodyString.substring(0,200),
y=void 0,d?d=y?(d=(d=d.replace(N," ").trim()).replace(H,"\\r\\n")).replace(new RegExp("((\\r\\n){"+y+"})[\\r\\n]*"),"$1"):d.replace(M," ").trim():d)
},c=1e4,f=3e5;case 12:
return r.prev=13,r.next=16,this.sendLog(n,u,i)
;case 16:if(h=r.sent,200!==(v=h.statusCode)){
r.next=20;break}return r.abrupt("return");case 20:
429===v||502===v||504===v?console.debug("Send log failed: Bad Connection"):a||(a=!0,
i("Send log status code == "+v)),r.next=26;break
;case 23:
r.prev=23,r.t0=r.catch(13),console.debug("Send log failed: Bad Connection")
;case 26:return r.next=28,O(c);case 28:
(c*=2)>f&&(c=f),r.next=12;break;case 32:case"end":
return r.stop()}var d,y}),r,this,[[13,23]])
}))),function(e){return t.apply(this,arguments)})
}]),o}(_);function I(){
return"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:null
}
var R=I(),F=Object.freeze(["debug","info","log","warn","error"]),B={
debug:R.console.debug.bind(R.console),
info:R.console.info.bind(R.console),
log:R.console.log.bind(R.console),
warn:R.console.warn.bind(R.console),
error:R.console.error.bind(R.console)}
;function D(e,r){r||(r=F);for(var t=function(t,n){
var o=r[t],i=B[o],a=e(o,i)
;if("function"!=typeof a&&a)return"continue"
;if(a){R.console[o]=function(){
a.apply(R.console,arguments)||i.apply(R.console,arguments)
}}},n=0,o=r.length;n<o;n++)t(n);return function(){
for(var e=0,t=r.length;e<t;e++){var n=r[e]
;R.console[n]=B[n]}}}var P=function(r){v(n,r)
;var t=m(n);function n(e,r){
return c(this,n),t.call(this,{
name:"writeToConsole",logger:e,allowLogLevels:r})}
return h(n,[{key:"init",value:function(){
this.interceptConsole()}},{key:"interceptConsole",
value:function(){var r=this;D((function(t,n){
var o=function(r){switch(r){case"debug":
return e.LogLevel.Debug;case"info":case"log":
return e.LogLevel.Info;case"warn":
return e.LogLevel.Warning;case"error":default:
return e.LogLevel.Error}
}(t),i="warn"===t||"error"===t?e.ActionMode.Never:e.ActionMode.Default
;return function(){
for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a]
;return r._logger.log({level:o,messagesOrErrors:t,
handlersModes:{writeToConsole:i}
}),n.apply(console,t.map((function(e){
return e instanceof Error?s(e):e}))),!0}}))}},{
key:"handleLog",value:function(r){
for(var t=0,n=r.length;t<n;t++){var o=r[t]
;switch(o.level){case e.LogLevel.None:
case e.LogLevel.Trace:case e.LogLevel.Debug:
B.debug(o.consoleString);break
;case e.LogLevel.Info:B.info(o.consoleString)
;break;case e.LogLevel.UserAction:
case e.LogLevel.Action:B.log(o.consoleString)
;break;case e.LogLevel.UserWarning:
case e.LogLevel.UserError:case e.LogLevel.Warning:
B.warn(o.consoleString);break
;case e.LogLevel.Error:case e.LogLevel.Fatal:
default:B.error(o.consoleString)}}}}]),n}(_)
;var W=function(){function r(t){
var n=t.level,o=t.messagesOrErrors,i=t.handlersModes,a=t.time,s=t.stack,l=t.additionalHashString,u=t.appState
;(c(this,r),
this.level=n||e.LogLevel.Error,this.messagesOrErrors=o,this.handlersModes=i,
this.time=a||new Date,
this.stack=s,this.additionalHashString=l,this.appState=u,this.stack)||function(r){
switch(r){case e.LogLevel.Error:return 50
;case e.LogLevel.Fatal:return 100
;case e.LogLevel.UserError:
case e.LogLevel.UserWarning:return 10
;case e.LogLevel.Warning:return 5;default:return 0
}
}(this.level)>0&&(this.stack=new Error("StackTrace").stack)
}return h(r,[{key:"messages",get:function(){
return null==this._messages&&(this._messages=this.messagesOrErrors?(Array.isArray(this.messagesOrErrors)?this.messagesOrErrors:[this.messagesOrErrors]).filter((function(e){
return!(e instanceof Error)})).map((function(e){
return e?"object"==typeof e?s(e):e.toString():e+""
})):[]),this._messages}},{key:"messagesString",
get:function(){
return null==this._messagesString&&(this._messagesString=this.messages.join("\r\n\r\n")),
this._messagesString}},{key:"errors",
get:function(){
return null==this._errors&&(this._errors=this.messagesOrErrors?(Array.isArray(this.messagesOrErrors)?this.messagesOrErrors:[this.messagesOrErrors]).filter((function(e){
return e instanceof Error})):[]),this._errors}},{
key:"errorsString",get:function(){
return null==this._errorsString&&(this._errorsString=this.errors.map(s).join("\r\n\r\n")),
this._errorsString}},{key:"consoleLevel",
get:function(){switch(this.level){
case e.LogLevel.None:case e.LogLevel.Trace:
case e.LogLevel.Debug:return"debug"
;case e.LogLevel.Info:return"info"
;case e.LogLevel.UserAction:
case e.LogLevel.Action:return"log"
;case e.LogLevel.UserWarning:
case e.LogLevel.UserError:case e.LogLevel.Warning:
return"warn";case e.LogLevel.Error:
case e.LogLevel.Fatal:default:return"error"}}},{
key:"consoleString",get:function(){
return null==this._consoleString&&(this._consoleString="\r\n["+this.dateString+"]["+e.LogLevel[this.level]+"]: "+this.bodyString),
this._consoleString}},{key:"dateString",
get:function(){
return null==this._timeString&&(this._timeString=this.time.toISOString().replace("T"," ").replace("Z","")),
this._timeString}},{key:"stackString",
get:function(){
return null==this._stackString&&(this._stackString=this.stack||""),
this._stackString}},{key:"appInfo",get:function(){
if(null==this._appInfo){var e=this.appState
;this._appInfo=e?JSON.stringify(e,null,4):""}
return this._appInfo}},{key:"md5Hash",
get:function(){if(!this._md5Hash){var e=[]
;this.additionalHashString&&e.push(this.additionalHashString)
;var r=this.errors
;if(r)for(var t=0,n=r.length;t<n;t++){
var o=r[t],i=o.stack||o.toString();if(i){
var a=i.indexOf("\n")
;a>=0&&(i=i.substring(a+1,i.length))}e.push(i)}
this.stack&&e.push(this.stack),this.appInfo&&e.push(this.appInfo)
;var s=e.join("\r\n");this._md5Hash=U(s)}
return this._md5Hash}},{key:"bodyString",
get:function(){if(!this._bodyString){var e=[]
;this.messagesString&&e.push(this.messagesString),
this.errorsString&&e.push(this.errorsString),
this.stackString&&e.push(this.stackString),
this._bodyString=e.join("\r\n\r\n")}
return this._bodyString}}]),r
}(),q=R.eval.bind(R.eval);function z(e){
return delete R.eval,R.eval=function(r){
return e(r,q)},function(){delete R.eval,R.eval=q}}
function V(e,r){return z((function(t,n){try{
return n.call(R,t)}catch(n){
throw r&&!r(t)||e("eval error",n,t),n}}))}
var $=function(){function r(){
c(this,r),this.minTimeBetweenEqualEvents=12e4,this._logEventsTime={},
this._subscribers=[]}var t;return h(r,[{
key:"_init",value:function(r){
var t=this,n=r.appName,o=r.appVersion,i=r.handlers,a=r.filter,s=r.appState,l=r.interceptEval
;if(this._initialized)this.error("Logger already initialized");else{
this._initialized=!0,
this.appName=n,this.appVersion=o
;for(var u={},c=0,f=i.length;c<f;c++){var h=i[c]
;h&&(u[h.name]=h,h.init())}
this.handlers=u,this.filter=a,this.appState=s,l&&V((function(){
t.error.apply(t,arguments)}));var g={
level:e.LogLevel.Info,
messagesOrErrors:"Start App: "+n+" v"+o,
handlersModes:{_all:e.ActionMode.Always}}
;this.log(g)}}},{key:"debug",value:function(){
for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n]
;this.log({level:e.LogLevel.Debug,
messagesOrErrors:t})}},{key:"info",
value:function(){
for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n]
;this.log({level:e.LogLevel.Info,
messagesOrErrors:t})}},{key:"action",
value:function(){
for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n]
;this.log({level:e.LogLevel.Action,
messagesOrErrors:t})}},{key:"warn",
value:function(){
for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n]
;this.log({level:e.LogLevel.Warning,
messagesOrErrors:t})}},{key:"error",
value:function(){
for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n]
;this.log({level:e.LogLevel.Error,
messagesOrErrors:t})}},{key:"log",
value:function(e){
if(null!=e&&"object"==typeof e)this._log(e instanceof W?e:this.createLogEvent(e));else{
for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n]
;this._log(this.createLogEvent({level:e,
messagesOrErrors:t}))}}},{key:"createLogEvent",
value:function(e){return e.appState=g({
appName:this.appName,appVersion:this.appVersion
},this.appState),new W(e)}},{key:"_log",
value:function(e){var r=this.filter;if(!r||r(e)){
var t=this._logEventsTime,n=t[e.bodyString]
;if(!(null!=n&&n+this.minTimeBetweenEqualEvents>e.time.getTime())){
t[e.bodyString]=e.time.getTime()
;var o=this.handlers
;for(var i in o)if(Object.prototype.hasOwnProperty.call(o,i)){
var a=o[i];a&&a.enqueueLog(e)}}}}},{
key:"subscribe",value:function(e){var r=this
;return this._subscribers.push(e),function(){
var t=r._subscribers.indexOf(e)
;t>=0&&r._subscribers.splice(t,1)}}},{key:"onLog",
value:(t=u(regeneratorRuntime.mark((function r(t){
var n,o
;return regeneratorRuntime.wrap((function(r){
for(;;)switch(r.prev=r.next){case 0:
if(!this._subscribers.length){r.next=16;break}n=0
;case 2:if(!(n<this._subscribers.length)){
r.next=16;break}
return o=this._subscribers[n],r.prev=4,r.next=7,o(t)
;case 7:r.next=13;break;case 9:
r.prev=9,r.t0=r.catch(4),this._subscribers.splice(n,1),
this.log(new W({level:e.LogLevel.Error,
messagesOrErrors:["onLog() error in "+o,r.t0]}))
;case 13:n++,r.next=2;break;case 16:case"end":
return r.stop()}}),r,this,[[4,9]])
}))),function(e){return t.apply(this,arguments)})
}]),r}();function J(e){return e.map((function(e){
return"undefined"!=typeof PromiseRejectionEvent&&e instanceof PromiseRejectionEvent?e.reason||e:"undefined"!=typeof Event&&"undefined"!=typeof Element&&e instanceof Event&&e.target instanceof Element&&"src"in e.target?"Error load: "+e.target.src+"\r\n"+e.target.outerHTML:e.reason||e
}))}function X(e){var r=!1;function t(t){
return function(){if(!r){
r=!0,setTimeout((function(){r=!1}))
;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i]
;e.apply(void 0,[t].concat(J(o)))}}}
var n=t("process.unhandledRejection"),o=t("process.uncaughtException"),i=t("unhandledrejection"),a=t("unhandled error")
;return"undefined"!=typeof process&&process.on&&process.on("unhandledRejection",n).on("uncaughtException",o),
void 0!==R&&R.addEventListener&&(R.addEventListener("unhandledrejection",i),
R.onunhandledrejection=i,
R.addEventListener("error",a,!0),R.onerror=a),function(){
"undefined"!=typeof process&&process.removeListener&&process.removeListener("unhandledRejection",n).removeListener("uncaughtException",o),
void 0!==R&&R.removeEventListener&&(R.removeEventListener("unhandledrejection",i),
R.onunhandledrejection=null,R.onerror=null)}}
function G(e,r){return fetch(e,{method:"POST",
mode:"cors",cache:"no-cache",
credentials:"same-origin",headers:{
"Content-Type":"application/json; charset=UTF-8",
"X-HASH":r.Hash,"X-TOKEN":r.Token},
redirect:"follow",referrer:"no-referrer",
body:JSON.stringify(r)}).then((function(e){return{
statusCode:e.status}}))}var K=function(e){v(t,e)
;var r=m(t);function t(){
return c(this,t),r.apply(this,arguments)}
return h(t,[{key:"sendLog",value:function(){
return G.apply(void 0,arguments)}}]),t
}(C),Z=function(r){v(o,r);var t,n=m(o)
;function o(e,r,t){var i
;return c(this,o),(i=n.call(this,{
name:"writeToFile",logger:e,allowLogLevels:r
}))._logFileName=t,i}return h(o,[{key:"handleLog",
value:(t=u(regeneratorRuntime.mark((function r(t){
var n,o
;return regeneratorRuntime.wrap((function(r){
for(;;)switch(r.prev=r.next){case 0:
if(n="undefined"!=typeof window?window.remoteLogger:null){
r.next=3;break}return r.abrupt("return");case 3:
return o=t.map((function(r){return{level:r.level,
dateString:r.dateString,appInfo:r.appInfo,
handlersModes:{_all:e.ActionMode.Never,
writeToFile:e.ActionMode.Always},
bodyString:r.bodyString}
})),r.next=6,n.writeToFile.apply(n,o);case 6:
case"end":return r.stop()}}),r)}))),function(e){
return t.apply(this,arguments)})},{
key:"logFileName",get:function(){
return this._logFileName},set:function(e){
this._logFileName=e,console.log("logFileName = "+this._logFileName),
"undefined"!=typeof window&&window.remoteLogger&&window.remoteLogger.setFileName(e)
}}]),o}(_),Q=function(r){v(n,r);var t=m(n)
;function n(){
return c(this,n),t.apply(this,arguments)}
return h(n,[{key:"init",value:function(r){
var t=this,o=r.appName,i=r.appVersion,a=r.logUrls,s=r.logFileName,l=r.writeToFileLevels,u=void 0===l?e.LogLevel.Any:l,c=r.writeToConsoleLevels,f=void 0===c?e.LogLevel.Any:c,h=r.sendLogLevels,g=void 0===h?e.LogLevel.Fatal|e.LogLevel.Error|e.LogLevel.Warning|e.LogLevel.UserError|e.LogLevel.UserWarning:h,v=r.emitEventLevels,d=void 0===v?e.LogLevel.Any:v,y=r.filter,b=r.appState
;r.interceptEval;if("undefined"!=typeof window){
var m=window.unsubscribeUnhandledErrors
;m&&(window.unsubscribeUnhandledErrors=null,m())}
X((function(){t.error.apply(t,arguments)
})),w(p(n.prototype),"_init",this).call(this,{
appName:o,appVersion:i,
handlers:[new P(this,f),a&&a.length&&L(A,[this].concat(a.map((function(e){
return new K(t,g,e)
})))),new k(this,d),new Z(this,u,s)],filter:y,
appState:b})}}]),n}($),Y=new Q
;return e.CONSOLE_LEVELS=F,e.CombineLogHandlers=A,
e.EmitEventHandler=k,e.LogEvent=W,
e.LogHandler=_,e.Logger=$,e.LoggerBrowser=Q,e.SendLogHandler=C,
e.SendLogHandlerBrowser=K,
e.WriteToConsoleHandler=P,e.WriteToFileHandler=Z,e.canDoAction=S,
e.catchEvalErrors=V,
e.catchUnhandledErrors=X,e.consoleOrig=B,e.delay=O,e.filterDefault=n,
e.getGlobalScope=I,
e.globalScope=R,e.handleLogErrorHandler=E,e.interceptConsole=D,
e.interceptEval=z,
e.logger=Y,e.objectToString=s,e.subscribeUnhandledErrors=function(e){
var r=void 0===e?{}:e,t=r.catchUnhandled,n=void 0===t||t,o=r.catchEval,i=void 0===o||o,a=r.catchConsoleLevels,l=void 0===a?["error"]:a,u=r.filterEval,c=void 0===u?null:u,f=r.alert,h=void 0!==f&&f,g=r.maxLogLength,v=void 0===g?2048:g,p=r.customLog,d=[]
;function y(){
for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t]
;var n=r.map((function(e){return s(e)
})).join("\n")
;v&&n.length>v&&(n=n.substring(0,v-3)+"..."),p&&p(n)||(h&&R.alert&&R.alert(n),
B.error(n))}return n&&d.push(X((function(){
"function"==typeof n&&n.apply(void 0,arguments)||n&&y.apply(void 0,arguments)
}))),l&&l.length>0&&d.push(D((function(e,r){var t
;if("function"==typeof l){
if("function"!=typeof(t=l(e,r))&&t)return t
}else if(Array.isArray(l)&&l.indexOf(e)<0)return null
;return function(){
for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n]
;t&&t.apply(void 0,r)||l&&y.apply(void 0,["console error"].concat(r))
}}))),i&&d.push(V((function(){
"function"==typeof i&&i.apply(void 0,arguments)||i&&y.apply(void 0,arguments)
}),c)),function(){
for(var e=0,r=d.length;e<r;e++)d[e]()}
},Object.defineProperty(e,"__esModule",{value:!0
}),e}({});
